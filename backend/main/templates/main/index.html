{% extends 'base.html' %}
{% block title %}Home | Magic Bar{% endblock %}

{% block content %}



  <!-- <div class="info">
    <h2>Bar Hours</h2>
    <ul>
      <li>Mon: Closed</li>
      <li>Tues–Thu: 3pm – 12am</li>
      <li>Fri–Sat: 3pm – 1am</li>
      <li>Sun: 12pm – 1am</li>
    </ul>
    <h2>Kitchen Hours</h2>
    <ul>
      <li>Mon: 4pm – 11pm</li>
      <li>Tue: Closed</li>
      <li>Wed–Thu: 4pm – 11pm</li>
      <li>Fri–Sat: 4pm – 1am</li>
      <li>Sun: 2pm – 9pm</li>
    </ul>
  </div> -->

  <!-- Swiper Carousel -->
  <div class="swiper mySwiper">
  <div class="swiper-wrapper">
    {% for img in carousel_images %}
      <div class="swiper-slide">
        <img src="{{ img.image.url }}" alt="Slide {{ forloop.counter }}">
      </div>
    {% endfor %}
  </div>

  <!-- Optional Pagination + Arrows -->
  <div class="swiper-pagination"></div>
  <div class="swiper-button-next"></div>
  <div class="swiper-button-prev"></div>
</div>

{% if events %}
<section class="events-section">
  <h2 class="events-title">Upcoming Events</h2>

  <a
  href="https://www.eventbrite.com/e/new-years-eve-at-little-magic-tickets-1978469151491?aff=oddtdtcreator&utm_source=ig&utm_medium=social&utm_content=link_in_bio&fbclid=PAZXh0bgNhZW0CMTEAc3J0YwZhcHBfaWQMMjU2MjgxMDQwNTU4AAGn90k2RR_ktjDoVd7qLmSMPNQfgFtb0jzqQVQsxRG_NCNY9-zfKqQmkOndK-4_aem_7d9MuE8IuQdaMnWnHuwCfg"
  class="cta-ticket-link"
  target="_blank"
  rel="noopener noreferrer"
>
  GET YOUR NYE TICKET HERE!
</a>

  <div class="events-grid">
    {% for e in events %}
      <div class="event-card">
        <img class="event-img" src="{{ e.image.url }}" alt="{{ e.title|default:'Event image' }}">
        <div class="event-body">
          {% if e.title %}<h3 class="event-name">{{ e.title }}</h3>{% endif %}
          <p class="event-caption">{{ e.caption }}</p>
        </div>
      </div>
    {% endfor %}
  </div>

  {% if user.is_staff %}
    <p class="event-admin-link"><a href="/admin/main/eventpost/">Manage Events</a></p>
  {% endif %}
</section>
{% endif %}



<section class="hours-block">
  <h2>Bar Hours of Operation</h2>
  <a
  href="https://www.google.com/maps/dir/?api=1&destination=Little+Magic+Bar+Johnson City+TN"
  target="_blank"
  rel="noopener"
>
  Get Directions
</a>

  <ul class="hours-list">
    {% for h in business_hours %}
      <li class="hours-row">
        <span class="day">{{ h.get_day_display }}</span>

        {% if h.is_closed %}
          <span class="time">Closed</span>
        {% else %}
          <span class="time">
            {{ h.open_time|time:"g:i A" }} – {{ h.close_time|time:"g:i A" }}
          </span>
        {% endif %}

        {% if h.notes %}
          <span class="notes">{{ h.notes }}</span>
        {% endif %}
      </li>
    {% endfor %}
  </ul>

  {% if user.is_authenticated %}
    <p class="hours-admin-link">
      <a href="/admin/main/businesshours/">Edit Hours</a>
    </p>
  {% endif %}
</section>




  <!-- Cocktail Menu -->
  <!-- {% if latest_menu %}
    <section>
      <h2>Cocktail Menu</h2>
      <img src="{{ latest_menu.image.url }}" alt="Cocktail Menu" style="max-width: 100%;">
    </section>
  {% endif %} -->

  <!-- Kitchen Menu -->
  <!-- {% if latest_kitchen_menu %}
    <section>
      <h2>Kitchen Menu</h2>
      <img src="{{ latest_kitchen_menu.image.url }}" alt="Kitchen Menu" style="max-width: 100%;">
    </section>
  {% endif %} -->

  <!-- Instagram Feed -->

  <section class="instagram-section">
    <h2 style="padding:1rem; text-align: center;">Latest Instagram Posts</h2>
    <div class="elfsight-app-1ee85006-7ad8-4898-94a9-66301cbc9ea3" data-elfsight-app-lazy></div>
  </section>
{% endblock %}

{% block extra_scripts %}
  <!-- Swiper JS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  // Prevent accidental double-init
  if (!window.__swiperInitialized) {
    window.__swiperInitialized = true;

    const slideCount = document.querySelectorAll('.mySwiper .swiper-slide').length;

    new Swiper('.mySwiper', {
      loop: slideCount >= 3,  // ✅ loop only if 3+ slides
      slidesPerView: 1,
      spaceBetween: 10,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      autoplay: slideCount >= 2 ? {
        delay: 5000,
        disableOnInteraction: false,
      } : false,
    });
  }
</script>



  <!-- Instagram Embed Script -->
  <script src="https://static.elfsight.com/platform/platform.js" async></script>
{% endblock %}
